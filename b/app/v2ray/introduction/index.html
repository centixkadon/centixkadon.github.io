<!DOCTYPE html>
<html lang=" en">

<head>
  <base href="/">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>v2ray 使用简介 | centixkadon</title>
<meta name="generator" content="Jekyll v4.2.2" />
<meta property="og:title" content="v2ray 使用简介" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="v2ray 是 Project V 的核心工具。Project V 是一个工具集合，它可以帮助你打造专属的基础通信网络。 v2ray 主要负责网络协议和功能的实现，与其它 Project V 通信。 v2ray 可以单独运行，也可以和其它工具配合，以提供简便的操作流程。" />
<meta property="og:description" content="v2ray 是 Project V 的核心工具。Project V 是一个工具集合，它可以帮助你打造专属的基础通信网络。 v2ray 主要负责网络协议和功能的实现，与其它 Project V 通信。 v2ray 可以单独运行，也可以和其它工具配合，以提供简便的操作流程。" />
<meta property="og:site_name" content="centixkadon" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-08-23T00:00:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="v2ray 使用简介" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2019-08-23T00:00:00+08:00","datePublished":"2019-08-23T00:00:00+08:00","description":"v2ray 是 Project V 的核心工具。Project V 是一个工具集合，它可以帮助你打造专属的基础通信网络。 v2ray 主要负责网络协议和功能的实现，与其它 Project V 通信。 v2ray 可以单独运行，也可以和其它工具配合，以提供简便的操作流程。","headline":"v2ray 使用简介","mainEntityOfPage":{"@type":"WebPage","@id":"/b/app/v2ray/introduction/"},"url":"/b/app/v2ray/introduction/"}</script>
<!-- End Jekyll SEO tag -->

  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" integrity="sha384-zCbKRCUGaJDkqS1kPbPd7TveP5iyJE0EjAuZQTgFLD2ylzuqKfdKlfG/eSrtxUkn" crossorigin>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.3/font/bootstrap-icons.min.css" integrity="sha384-kFHJmrKG9yBg+A4HPuKUdTgXd7SDmjlrPWHN0ORWH8OnniDPipnDcm2R5wYw0RZw" crossorigin>
  
  <link rel="stylesheet" href="css/main.css">
</head>

<body>
  <nav class="navbar navbar-expand-sm navbar-light bg-light sticky-top">
    <div class="container">
      <a class="navbar-brand" href="/">C</a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapse">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbar-collapse">
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link" href="/posts/">Posts</a>
          </li>
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/tools/">Tools</a>
          </li>
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/about/">About</a>
          </li>
          
          
          
          
        </ul>
      </div>
    </div>
  </nav>
  <main>
    <div class="container-fluid">
      <div class="row">
  <div class="col">
    <h1 id="v2ray 使用简介">v2ray 使用简介</h1>
    <p>v2ray 是 Project V 的核心工具。Project V 是一个工具集合，它可以帮助你打造专属的基础通信网络。 v2ray 主要负责网络协议和功能的实现，与其它 Project V 通信。 v2ray 可以单独运行，也可以和其它工具配合，以提供简便的操作流程。</p>

<h2 id="下载">下载</h2>

<p>在 <a href="https://github.com/v2ray/v2ray-core/releases">Releases · v2ray/v2ray-core · GitHub</a> 下载最新的 v2ray 二进制文件。其原生支持许多桌面和服务器平台，包括 Linux 和 Windows 。 Linux 还支持脚本安装到系统， Windows 和 macOS 则是一份可直接运行的命令行程序。</p>

<p>然后在 <a href="https://github.com/v2ray/domain-list-community/releases">Releases · v2ray/domain-list-community · GitHub</a> 下载最新的 dlc.dat 文件，重命名为 geosite.dat 并替换掉文件夹中原来的 geosite.dat 。这是 v2ray 工具的一部分，专门负责维护域名列表，其更新频率目前比 v2ray 高，所以 v2ray 中自带的 .dat 文件可能已经很旧了。</p>

<h2 id="平台支持安装和运行">平台支持、安装和运行</h2>

<p>见<a href="https://www.v2ray.com/chapter_00/install.html">下载安装 · Project V 官方网站</a>或 <a href="https://www.v2ray.com/">Project V · Project V 官方网站</a>。</p>

<p>上述两个网站需要翻墙。简单说明就是 Windows 平台下载 v2ray-windows-64.zip 文件，解压出文件夹直接运行 v2ray.exe 即可；若不能使用则下载 v2ray-windows-32.zip 文件； Linux 平台执行脚本安装即可。</p>

<h3 id="开机启动">开机启动</h3>

<p>Windows 平台的 v2ray 二进制文件有 v2ray.exe 和 wv2ray.exe ，两者均可以双击运行。运行 v2ray.exe 时能保留命令行界面，可以直接关闭；运行 wv2ray.exe 时没有界面，一般通过任务管理器结束进程。</p>

<p>可以右键单击 wv2ray.exe 创建快捷方式，并将快捷方式复制到 %APPDATA%\Microsoft\Windows\Start Menu\Programs\Startup 实现后台开机启动。</p>

<h2 id="v2ray-电脑客户端配置">v2ray 电脑客户端配置</h2>

<p>Windows 和 Linux 平台的 v2ray 客户端配置非常简单，将其他人提供的 config.json 替换掉原来的文件，重新运行即可。</p>

<p>诶，怎么配置？这不是这篇文章的重点。如果想深入学习，请去 <a href="https://www.v2ray.com/">Project V · Project V 官方网站</a>从头学起。</p>

<h3 id="浏览器配置">浏览器配置</h3>

<p>连接 v2ray 入口的方法是配置代理，而各个应用程序有各个应用程序的代理配置方法。以下基于原生的 v2ray ，用 Firefox 配置 socks 代理举例，其它应用程序和代理协议同理。也有各平台的第三方 GUI 工具，在<a href="https://www.v2ray.com/awesome/tools.html">神一样的工具们 · Project V 官方网站</a>列出了部分推荐。</p>

<h4 id="firefox">Firefox</h4>

<ol>
  <li>找到 <abbr title="打开菜单">Open menu</abbr> ，点击 <abbr title="打开菜单">Open menu</abbr> → <abbr title="选项">Options</abbr> 。</li>
  <li>找到 <abbr title="网络设置">Network Settings</abbr> 。</li>
  <li>点击 <abbr title="设置">Settings...</abbr>。</li>
  <li>选择 <abbr title="手动代理配置">Manual proxy configuration</abbr> 。</li>
  <li>取消选择 Use this proxy server for all protocols 。</li>
  <li><abbr title="SOCKS 主机">SOCKS Host</abbr> 填 127.0.0.1 和 config.json 中 inbound 的 port 。
    <ul>
      <li>如果 v2ray 在局域网的其它机器运行，则应填其它机器的 ip地址 或 域名。</li>
    </ul>
  </li>
  <li>选择 SOCKS v5 。</li>
  <li>点击 <abbr title="确定">OK</abbr> 。</li>
</ol>

<p>更高级的代理配置，不应直接使用浏览器自带配置。可以安装 <a href="https://addons.mozilla.org/en-US/firefox/addon/switchyomega/">Proxy SwitchyOmega – Get this Extension for 🦊 Firefox (en-US)</a> ，插件配置方法略过不提。</p>

<h4 id="chrome">Chrome</h4>

<p>一般直接安装 <a href="https://chrome.google.com/webstore/detail/proxy-switchyomega/padekgcemlokbadohgkifijomclgjgif">Proxy SwitchyOmega - Chrome Web Store</a> ，做高级的代理配置。</p>

<h3 id="全局配置">全局配置</h3>

<p>一般不建议全局配置，因为这样会导致电脑上三教九流的软件都可能经过 v2ray 。如果其中有什么流氓软件，也许会带来安全隐患。另外，下文提到的最简单的配置方法是非强制的，软件完全可以自己选择听不听，所以这种配置对网络连接不可控。如果非要做全局配置，比如为了查找错误什么的，可以尝试一下。</p>

<ol>
  <li>Windows 10 下，按 Windows 键，输入 Internet 选项，回车。</li>
  <li>点击 连接。</li>
  <li>点击 局域网设置。</li>
  <li>选择 为 LAN 使用代理服务器：
    <ul>
      <li>地址： 127.0.0.1 。</li>
      <li>端口： config.json 中 inbound 的 port 。</li>
    </ul>
  </li>
  <li>将 config.json 中 inbound 的 protocol 改成 http 。</li>
</ol>

<h2 id="v2ray-手机端配置">v2ray 手机端配置</h2>

<p>全局配置需要局域网中有一台运行 v2ray 的电脑，不要求手机安装任何 v2ray 客户端；客户端配置不需要电脑。</p>

<h3 id="全局配置-1">全局配置</h3>

<ol>
  <li>将手机和运行 v2ray 的电脑连到同一局域网。</li>
  <li>将电脑客户端 config.json 中 inbound 的 listen 改成 0.0.0.0 。</li>
  <li>将电脑客户端 config.json 中 inbound 的 protocol 改成 http 。</li>
  <li>重启电脑客户端的 v2ray 。</li>
  <li>进入手机 WLAN 设置，修改网络。</li>
  <li>配置代理为手动：
    <ul>
      <li>地址：电脑的 ip 地址</li>
      <li>端口：电脑客户端 config.json 中 inbound 的 port 。</li>
    </ul>
  </li>
  <li>重新连接手机 WLAN 。</li>
</ol>

<h3 id="客户端配置">客户端配置</h3>

<p><a href="https://www.v2ray.com/awesome/tools.html">神一样的工具们 · Project V 官方网站</a>有许多手机客户端推荐。 Android 平台可以在 Google Play 免费下载 v2rayNG 或 Kitsunebi ， iOS 平台应用均需要付费，其中 Kitsunebi 应该和 Android 客户端一样。</p>

<p>下面以 v2rayNG 为例：</p>

<ol>
  <li>点击 右上角的添加配置。</li>
  <li>手动输入[Vmess]，并根据 config.json 中 outbounds 里 protocol 为 vmess 一项的键值配置以下内容：
    <ul>
      <li>别名：随便写。</li>
      <li>地址： settings.vnext.address 。</li>
      <li>端口： settings.vnext.port 。</li>
      <li>用户 ID ： settings.vnext.users.id 。</li>
      <li>额外 ID ： settings.vnext.users.alterId 。</li>
      <li>加密方式： settings.vnext.users.security 。</li>
      <li>传输协议： streamSettings.network （没有则留空）。</li>
      <li>伪装域名： streamSettings.xxxSettings.host （没有则留空）。</li>
      <li>path ： streamSettings.xxxSettings.path （没有则留空）。</li>
      <li>底层传输安全： streamSettings.security （没有则留空）。</li>
      <li>点击 右上角的保存配置。</li>
    </ul>
  </li>
  <li>点击 左上角 并进入 设置：
    <ol>
      <li>点击 分应用代理：
        <ul>
          <li>选择 分应用代理。</li>
          <li>点击 右上角的更多选项。</li>
          <li>点击 自动选中需代理应用。</li>
          <li>点击 左上角。</li>
        </ul>
      </li>
      <li>路由设置：
        <ul>
          <li>点击 域名策略： AsIs 。</li>
          <li>点击 路由模式：绕过局域网及大陆网址。</li>
        </ul>
      </li>
    </ol>
  </li>
</ol>

<h2 id="常见问题">常见问题</h2>

<ol>
  <li>运行 v2ray 发现闪退/没有界面。
    <ul>
      <li>一般是配置文件有问题；其次可能电脑上已经运行了 v2ray 或 wv2ray ，请通过任务管理器结束所有相关进程。</li>
    </ul>
  </li>
  <li>运行 wv2ray 发现没有界面。
    <ul>
      <li>wv2ray 是在后台运行，没有界面，所以这种情况是正常的。</li>
    </ul>
  </li>
  <li>我拿到客户端配置文件之后可以改哪里？
    <ul>
      <li>outbounds 是和其它服务器通信的配置，所以只有客户端的配置文件一般无需也不能更改。</li>
      <li>log 一般也不会自己看，能找到那两个文件即可。</li>
      <li>inbounds 是应用程序连接的入口，如果应用程序连不上可以检查 protocol ，如果发现其它应用程序偷偷连可以更改 port 。
        <ul>
          <li>inbounds 中的 port 和应用程序代理配置中的 port 对应，改的话要一起改哦。</li>
        </ul>
      </li>
      <li>routing 可以基于域名或 ip 来决定流量走哪个出口。示例中的 rules 最后一条是无条件直接连接，所以是典型的黑名单配置。如果实际使用中发现有其它需要添加进黑名单的，可以添加到前面对应的规则里。</li>
    </ul>
  </li>
  <li>我更改了配置文件，想要让流量 xxx ，但是 yyy 了。
    <ul>
      <li>首先检查 inbounds 配置和应用程序配置，然后检查 routing 配置和 outbounds 配置。</li>
      <li>即使将相应的流量转发到其他服务器，服务器上也会有一套规则来决定连还是不连哦。</li>
    </ul>
  </li>
  <li>我自己找不出问题了。
    <ul>
      <li>把两个日志文件发给别人求助吧。</li>
    </ul>
  </li>
</ol>

  </div>
</div>
    </div>
  </main>
  <footer>
    <div class="container-fluid">
      <div class="row">
        <div class="col d-flex">
          <div class="mr-auto mt-auto mb-3">© 2022 centixkadon</div>
        </div>
        <div class="col-1">
          <div class="py-3"></div>
          <div class="py-3"></div>
        </div>
      </div>
    </div>
  </footer>
  
  <footer class="fixed-bottom pointer-events-none">
    <div class="container-fluid">
      <div class="row">
        <div class="col-1">
          <div class="py-3"></div>
          <div class="py-3"></div>
        </div>
        <div class="col d-flex">
          <div class="ml-auto mt-auto mb-3">
            <button class="btn btn-outline-secondary rounded-circle bi-arrow-up pointer-events-all" v-on:click="scrollTop"></button>
          </div>
        </div>
      </div>
    </div>
  </footer>
  

  
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-fQybjgWLrvvRgtW6bFlB7jaZrFsaBXjsOMm/tB9LTS58ONXgqbR9W8oWht/amnpF" crossorigin></script>
  <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.min.js" integrity="sha384-ULpZhk1pvhc/UK5ktA9kwb2guy9ovNSTyxPNHANnA35YjBQgdwI+AhLkixDvdlw4" crossorigin></script>
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK" crossorigin></script>
  
  
<script>
  document.addEventListener("readystatechange", async function () {
    if (this.readyState !== "interactive") {
      return;
    }

    document.querySelectorAll('main').forEach($dom => $dom.classList.add(..."mx-sm-3 mx-md-4 mx-lg-5".split(" ")));
    document.querySelectorAll('main h1, main .h1').forEach($dom => $dom.classList.add(..."mt-4 mt-lg-5 mb-4".split(" ")));
    document.querySelectorAll('main h2, main .h2').forEach($dom => $dom.classList.add(..."mt-4 mt-lg-5 mb-4".split(" ")));
    document.querySelectorAll('main h3, main .h3').forEach($dom => $dom.classList.add(..."mt-4 mb-4".split(" ")));
    document.querySelectorAll('main h4, main .h4').forEach($dom => $dom.classList.add(..."mt-4 mb-4".split(" ")));
    document.querySelectorAll('main blockquote').forEach($dom => $dom.classList.add(..."blockquote alert alert-primary".split(" ")));
    document.querySelectorAll('main blockquote p').forEach($dom => $dom.classList.add(..."mb-0".split(" ")));
    document.querySelectorAll('main blockquote footer').forEach($dom => $dom.classList.add(..."blockquote-footer text-right".split(" ")));

    const headings = {};
    document.querySelectorAll('main h2').forEach($dom => {
      headings[$dom.id] = $dom;
    });

    document.addEventListener("scroll", function () {
      const [id, $heading] = Object.entries(headings).reduce(([id, $heading], [newId, $newHeading]) => {
        if ($heading.offsetTop < $newHeading.offsetTop && $newHeading.offsetTop <= scrollY) {
          return [newId, $newHeading];
        }
        return [id, $heading];
      }, ["", { offsetTop: 0 }]);
      if (decodeURIComponent(location.hash.slice(1)) !== id) {
        const hash = id === "" ? "" : `#${encodeURIComponent(id)}`;
        const url = `${location.origin}${location.pathname}${hash}`;
        history.replaceState({ a: 1 }, "", url);
      }
    });

    const locks = {};

    Vue.mixin({
      methods: {
        random() {
          const b = Math.pow(0.5, 32);
          const array = crypto.getRandomValues(new Uint32Array(4));
          return Array.from(array).reduce((n, x) => (n + x) * b, 0);
        },

        // code
        arrayFromString(string) {
          return new TextEncoder().encode(string);
        },
        arrayToString(array) {
          return new TextDecoder().decode(array);
        },
        hexFromString(string) {
          return new Uint8Array(string.match(/[\da-fA-F]{1,2}/g).map(x => parseInt(x, 16)));
        },
        hexToString(array) {
          return Array.from(array).map(x => x.toString(16).padStart(2, '0')).join('');
        },
        base64FromString(string) {
          return Uint8Array.from(atob(string), c => c.charCodeAt(0));
        },
        base64ToString(array) {
          return btoa(String.fromCharCode(...new Uint8Array(array)));
        },
        base64urlFromString(string) {
          return this.base64FromString(string.replace(/-/g, "+").replace(/_/g, "/"));
        },
        base64urlToString(array) {
          return this.base64ToString(array).replace(/\+/g, "-").replace(/\//g, "_").replace("=", "");
        },
        base64Encode(string) {
          return this.base64ToString(this.arrayFromString(string));
        },
        base64Decode(string) {
          return this.arrayToString(this.base64FromString(string));
        },

        // digest
        async digest(message, algorithm) {
          return new Uint8Array(await crypto.subtle.digest(algorithm, this.arrayFromString(message)));
        },
        async sha1(message) {
          return await this.digest(message, "SHA-1");
        },
        async sha256(message) {
          return await this.digest(message, "SHA-256");
        },
        async sha384(message) {
          return await this.digest(message, "SHA-384");
        },
        async sha512(message) {
          return await this.digest(message, "SHA-512");
        },

        // crypt
        async aesGcmKey(password) {
          const hashArray = (await this.sha512(password)).slice(0, 32);
          const jwk = {
            k: this.base64urlToString(hashArray),
            kty: ""
          };
          return await crypto.subtle.importKey("jwk", jwk, { name: "AES-GCM" }, true, ["encrypt", "decrypt"]);
        },
        async aesGcmEncrypt(message, password) {
          const ivArray = crypto.getRandomValues(new Uint8Array(12));
          const algorithm = { name: "AES-GCM", iv: ivArray };
          const key = await this.aesGcmKey(password);
          const decryptArray = this.arrayFromString(message);
          const encryptArray = await crypto.subtle.encrypt(algorithm, key, decryptArray);
          return {
            data: this.base64ToString(encryptArray),
            iv: this.hexToString(ivArray)
          };
        },
        async aesGcmDecrypt({ data: data, iv: iv }, password) {
          const ivArray = this.hexFromString(iv);
          const algorithm = { name: "AES-GCM", iv: ivArray };
          const key = await this.aesGcmKey(password);
          const encryptArray = this.base64FromString(data);
          const decryptArray = await crypto.subtle.decrypt(algorithm, key, encryptArray);
          return this.arrayToString(decryptArray);
        },

        // lock
        lock(key, func) {
          if (!locks[key]) {
            locks[key] = true;
            func.apply(this);
            vm.$nextTick(() => {
              locks[key] = false;
            });
          }
        },
        async alock(key, afunc) {
          if (!locks[key]) {
            locks[key] = true;
            await afunc.apply(this);
            vm.$nextTick(() => {
              locks[key] = false;
            });
          }
        },

        // load, store
        load(key, defaultJson) {
          defaultJson = defaultJson || "{}";
          return JSON.parse(localStorage.getItem(key) || defaultJson);
        },
        store(key, json) {
          if (json == undefined) {
            localStorage.removeItem(key);
          } else {
            localStorage.setItem(key, JSON.stringify(json));
          }
        },
      }
    });

    new Vue({
      el: "footer.fixed-bottom",
      data: {
        scroll: true,
      },
      methods: {
        scrollTop() {
          const vm = this;
          if (vm.scroll) {
            for (const selector of ['html', 'body']) {
              if ($(selector).scrollTop() !== 0) {
                vm.scroll = false;
                $(selector).animate({ scrollTop: 0 }, function () {
                  vm.scroll = true;
                });
              }
            }
          }
        }
      },
    })

  });
</script>

  
</body>

</html>