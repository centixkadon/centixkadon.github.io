<!DOCTYPE html>
<html lang="en">

<head>
  <base href="../..">

  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">

  <link rel="stylesheet" href="javascript/bootstrap/css/bootstrap.min.css">
  <style>
    #rd1div {
      height: calc(100vh - 11.2rem);
      line-height: calc(82vh - 10rem);
      overflow: hidden;
    }
    .rdw {
      font-size: calc(175vw);
    }
    .rdh {
      font-size: calc(100vh - 12rem);
    }
    @media (min-width: 576px) {
      #rd1div {
        height: calc(100vh - 6rem);
        line-height: calc(82vh - 5.4rem);
        overflow: hidden;
      }
      .rdw {
        font-size: calc(175vw);
      }
      .rdh {
        font-size: calc(100vh - 6.5rem);
      }
    }
  </style>

  <title>随机数生成器</title>
</head>

<body>
  <div class="container-fluid">
    <main class="my-3">
      <div class="row mb-3">
        <div class="col-sm col-lg col-xl input-group">
          <div class="input-group-prepend mb-1">
            <span class="input-group-text">下界(含)</span>
          </div>
          <input id="n1" type="text" class="form-control" placeholder="下界">
        </div>
        <div class="col-sm col-lg col-xl input-group">
          <div class="input-group-prepend mb-1">
            <span class="input-group-text">上界(含)</span>
          </div>
          <input id="n2" type="text" class="form-control" placeholder="上界">
        </div>
        <div class="col-sm col-lg-3 col-xl-2 input-group">
          <div class="input-group-prepend mb-1">
            <span class="input-group-text">字体大小</span>
          </div>
          <input id="k" type="text" class="form-control" placeholder="字体">
        </div>
      </div>
      <div class="row">
        <div id="rd1div" class="btn btn-block">
          <div id="rd1" style="font-size: 0em">0</div>
          <div class="rdw"></div>
          <div class="rdh"></div>
        </div>
      </div>
    </main>
  </div>

  <script src="javascript/jquery/jquery.min.js"></script>
  <script>
    $(function () {
      function checkNumber(a, b) {
        if (a === "") return b;
        return parseFloat(isNaN(a) ? b : a);
      }

      let [n1, n2, k] = [1, 100, 1];
      $("#n1").change((function () {
        let n1_ = Math.round(checkNumber($("#n1").val(), n1));
        $("#n1").val(n1 = n1_);
        return arguments.callee;
      })());
      $("#n2").change((function () {
        let n2_ = Math.round(checkNumber($("#n2").val(), n2));
        $("#n2").val(n2 = n2_);
        return arguments.callee;
      })());

      $("#k").change((function () {
        let k_ = checkNumber($("#k").val(), k);
        if (k_ <= 0) k_ = k;
        $("#k").val(k = k_);
        $("#rd1").css("font-size", $("#k").val() + "em");
        return arguments.callee;
      })());

      function rdResize() {
        let l = Math.max(n1.toString().length, n2.toString().length);
        let szw = parseFloat($(".rdw").css("font-size")) / l;
        let szh = parseFloat($(".rdh").css("font-size"));
        $("#rd1div").css("font-size", Math.min(szw, szh));
      }
      rdResize();
      $(window).resize(rdResize);
      $("#n1,#n2").change(rdResize);

      let tid = -1;
      function toggleRandom() {
        if (tid === -1) {
          tid = setInterval(function () {
            $("#rd1").html(Math.floor(Math.min(n1, n2) + Math.random() * (Math.abs(n2 - n1) + 1)));
          }, 0);
        } else {
          clearInterval(tid);
          tid = -1;
        }
      }
      $("body").keydown(function (e) { e.keyCode === 13 && toggleRandom(); });
      $("#rd1").click(toggleRandom);

    });
  </script>
</body>

</html>